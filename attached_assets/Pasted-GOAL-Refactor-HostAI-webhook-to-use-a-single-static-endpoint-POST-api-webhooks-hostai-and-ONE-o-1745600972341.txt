GOAL
Refactor HostAI webhook to use a single static endpoint
    POST /api/webhooks/hostai
and ONE optional secret (Bearer token). Remove all other HostAI-specific
env vars & dynamic URL params.

CONTEXT
â€¢ Repo layout: /server (Express + Drizzle), /shared/schema.ts, /client, /tests.
â€¢ Webhook JSON spec (from HostAI screenshot) already modelled in schema.
â€¢ Drizzle PostgreSQL DB, ws broadcast helper available as ws.broadcast().
â€¢ Testing stack: Vitest + Supertest.

TASKS
1. ğŸ§¹  Cleanup env
   â€¢ Delete any HOSTAI_* vars from code & .env.example.
   â€¢ Add WEBHOOK_SECRET to .env.example (optional).

2. ğŸ”  Env validation
   â€¢ In env.ts (create if missing) load process.env, validate with Zod:
     { WEBHOOK_SECRET: z.string().optional() }
   â€¢ Export as `env`.

3. ğŸš  Rewrite route
   â€¢ Replace existing HostAI router(s) with `/server/webhooks/hostai.ts`
     â€“ POST /api/webhooks/hostai
     â€“ If env.WEBHOOK_SECRET is set, expect header
         Authorization: Bearer <secret>
       â†’ else skip auth.
     â€“ Validate req.body with Zod schema (copy from previous prompt).
     â€“ Call `saveTaskFromHostAI(payload)` and return 200.

4. ğŸ›   Service helper
   â€¢ Add/extend `server/services/taskService.ts` :
       async function saveTaskFromHostAI(payload)
       â€“ Derive team_target & urgency (simple heuristics)
       â€“ Insert into tasks + task_attachments (Drizzle)
       â€“ Broadcast ws.broadcast("task:new", insertedTask)

5. ğŸ“¡  routes.ts
   â€¢ `app.use("/api/webhooks", hostaiRouter)`

6. âœ…  Tests
   â€¢ `tests/webhooks/hostai.spec.ts`
     â€“ 200 happy path (valid body + correct secret)
     â€“ 401 invalid secret
     â€“ 422 bad payload
     â€“ 409 duplicate external_id

7. ğŸ“  CHANGELOG.md
   â€¢ Summarise breaking changes (removed HOSTAI_* env vars).

ERROR HANDLING
â€¢ 401 when secret mismatch.
â€¢ 422 Zod validation error.
â€¢ 409 duplicate task (external_id + listing_id unique).

PERFORMANCE
Total handler latency â‰¤200 ms incl. DB insert (99-percentile).

AFTER CODING
Run:
  pnpm db:push && pnpm lint && pnpm test
Ensure all tests green.

OUTPUT
Return full code diffs for every created/modified file plus commands to
set WEBHOOK_SECRET in Replit Secrets:

  replit secrets add WEBHOOK_SECRET="super_long_token"
